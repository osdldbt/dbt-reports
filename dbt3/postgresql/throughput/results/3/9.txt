BEGIN;
BEGIN
select
	nation,
	o_year,
	sum(amount) as sum_profit
from
	(
		select
			n_name as nation,
			extract(year from o_orderdate) as o_year,
			l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
		from
			part,
			supplier,
			lineitem,
			partsupp,
			orders,
			nation
		where
			s_suppkey = l_suppkey
			and ps_suppkey = l_suppkey
			and ps_partkey = l_partkey
			and p_partkey = l_partkey
			and o_orderkey = l_orderkey
			and s_nationkey = n_nationkey
			and p_name like '%blush%'
	) as profit
group by
	nation,
	o_year
order by
	nation,
	o_year desc;
          nation           | o_year |   sum_profit   
---------------------------+--------+----------------
 ALGERIA                   |   1998 | 271590411.8581
 ALGERIA                   |   1997 | 460987441.2554
 ALGERIA                   |   1996 | 467417015.5967
 ALGERIA                   |   1995 | 467545115.1338
 ALGERIA                   |   1994 | 460720590.0014
 ALGERIA                   |   1993 | 461901702.8623
 ALGERIA                   |   1992 | 464907407.2429
 ARGENTINA                 |   1998 | 273205102.0076
 ARGENTINA                 |   1997 | 470220268.4395
 ARGENTINA                 |   1996 | 468877617.2147
 ARGENTINA                 |   1995 | 472819442.7338
 ARGENTINA                 |   1994 | 463994660.4255
 ARGENTINA                 |   1993 | 468161433.6355
 ARGENTINA                 |   1992 | 466703359.2065
 BRAZIL                    |   1998 | 272711327.9559
 BRAZIL                    |   1997 | 462189001.3190
 BRAZIL                    |   1996 | 470537624.7479
 BRAZIL                    |   1995 | 471686641.4610
 BRAZIL                    |   1994 | 469843920.4459
 BRAZIL                    |   1993 | 463910609.4386
 BRAZIL                    |   1992 | 476470819.0338
 CANADA                    |   1998 | 281423159.3942
 CANADA                    |   1997 | 480328565.8403
 CANADA                    |   1996 | 474179068.0720
 CANADA                    |   1995 | 481836103.2162
 CANADA                    |   1994 | 488901859.1859
 CANADA                    |   1993 | 477673018.8280
 CANADA                    |   1992 | 473957023.4090
 CHINA                     |   1998 | 271832706.6558
 CHINA                     |   1997 | 456359394.1341
 CHINA                     |   1996 | 472372109.5965
 CHINA                     |   1995 | 470517354.2657
 CHINA                     |   1994 | 465885049.3407
 CHINA                     |   1993 | 468241883.9155
 CHINA                     |   1992 | 472889917.2218
 EGYPT                     |   1998 | 272121660.0072
 EGYPT                     |   1997 | 471331668.1261
 EGYPT                     |   1996 | 473621398.3593
 EGYPT                     |   1995 | 464533892.8366
 EGYPT                     |   1994 | 457540949.0064
 EGYPT                     |   1993 | 468153939.9501
 EGYPT                     |   1992 | 469861551.2280
 ETHIOPIA                  |   1998 | 265307849.2744
 ETHIOPIA                  |   1997 | 455227302.0290
 ETHIOPIA                  |   1996 | 451255909.9948
 ETHIOPIA                  |   1995 | 455635100.5634
 ETHIOPIA                  |   1994 | 456800568.4290
 ETHIOPIA                  |   1993 | 459413892.8390
 ETHIOPIA                  |   1992 | 459426255.1645
 FRANCE                    |   1998 | 274749301.0199
 FRANCE                    |   1997 | 465296132.9144
 FRANCE                    |   1996 | 466510828.7395
 FRANCE                    |   1995 | 459281868.8898
 FRANCE                    |   1994 | 460745606.2495
 FRANCE                    |   1993 | 463020321.9648
 FRANCE                    |   1992 | 462027466.4666
 GERMANY                   |   1998 | 280134215.7090
 GERMANY                   |   1997 | 478403656.9329
 GERMANY                   |   1996 | 477277205.2118
 GERMANY                   |   1995 | 465779782.5778
 GERMANY                   |   1994 | 482887011.9653
 GERMANY                   |   1993 | 475136715.3377
 GERMANY                   |   1992 | 480697538.7123
 INDIA                     |   1998 | 277232879.0112
 INDIA                     |   1997 | 466591843.2808
 INDIA                     |   1996 | 472119368.8454
 INDIA                     |   1995 | 477385789.7492
 INDIA                     |   1994 | 470019810.6063
 INDIA                     |   1993 | 469721788.5050
 INDIA                     |   1992 | 477862103.5340
 INDONESIA                 |   1998 | 276311326.5662
 INDONESIA                 |   1997 | 462140627.0070
 INDONESIA                 |   1996 | 466934694.2964
 INDONESIA                 |   1995 | 469695653.0881
 INDONESIA                 |   1994 | 465411428.2183
 INDONESIA                 |   1993 | 469216641.3460
 INDONESIA                 |   1992 | 459690825.1489
 IRAN                      |   1998 | 272635452.8065
 IRAN                      |   1997 | 466101489.1959
 IRAN                      |   1996 | 471853578.2092
 IRAN                      |   1995 | 471568489.0488
 IRAN                      |   1994 | 468133002.7222
 IRAN                      |   1993 | 464493785.9931
 IRAN                      |   1992 | 465990398.0826
 IRAQ                      |   1998 | 276367492.9584
 IRAQ                      |   1997 | 472686844.9871
 IRAQ                      |   1996 | 478299902.8121
 IRAQ                      |   1995 | 472776887.4643
 IRAQ                      |   1994 | 476028365.1037
 IRAQ                      |   1993 | 476475775.1182
 IRAQ                      |   1992 | 475803734.2671
 JAPAN                     |   1998 | 274527056.3511
 JAPAN                     |   1997 | 465150015.0600
 JAPAN                     |   1996 | 464750326.1819
 JAPAN                     |   1995 | 458736165.9642
 JAPAN                     |   1994 | 453144214.9162
 JAPAN                     |   1993 | 463747242.2359
 JAPAN                     |   1992 | 464081649.9022
 JORDAN                    |   1998 | 273711130.6638
 JORDAN                    |   1997 | 469845023.2847
 JORDAN                    |   1996 | 461159840.0994
 JORDAN                    |   1995 | 455241251.0404
 JORDAN                    |   1994 | 463131978.5712
 JORDAN                    |   1993 | 466235941.5323
 JORDAN                    |   1992 | 464383939.4834
 KENYA                     |   1998 | 272077344.0450
 KENYA                     |   1997 | 468727506.6124
 KENYA                     |   1996 | 473304744.8397
 KENYA                     |   1995 | 472172631.2135
 KENYA                     |   1994 | 474357545.8718
 KENYA                     |   1993 | 470267784.5004
 KENYA                     |   1992 | 475584106.6642
 MOROCCO                   |   1998 | 267053326.9254
 MOROCCO                   |   1997 | 470276266.7285
 MOROCCO                   |   1996 | 468150472.6136
 MOROCCO                   |   1995 | 463754904.8460
 MOROCCO                   |   1994 | 461331484.3486
 MOROCCO                   |   1993 | 467148174.5859
 MOROCCO                   |   1992 | 466243667.3100
 MOZAMBIQUE                |   1998 | 271832718.1608
 MOZAMBIQUE                |   1997 | 455971792.3269
 MOZAMBIQUE                |   1996 | 455418677.8225
 MOZAMBIQUE                |   1995 | 459688522.4527
 MOZAMBIQUE                |   1994 | 463272017.5343
 MOZAMBIQUE                |   1993 | 460227010.1588
 MOZAMBIQUE                |   1992 | 462539277.3341
 PERU                      |   1998 | 269708069.6827
 PERU                      |   1997 | 470762394.4046
 PERU                      |   1996 | 473203916.1041
 PERU                      |   1995 | 468292182.0142
 PERU                      |   1994 | 460988957.9603
 PERU                      |   1993 | 471549921.3759
 PERU                      |   1992 | 462802145.9564
 ROMANIA                   |   1998 | 276447659.8693
 ROMANIA                   |   1997 | 466064449.1279
 ROMANIA                   |   1996 | 472986926.3015
 ROMANIA                   |   1995 | 468934527.7825
 ROMANIA                   |   1994 | 466724647.7154
 ROMANIA                   |   1993 | 474363172.6901
 ROMANIA                   |   1992 | 473062508.0960
 RUSSIA                    |   1998 | 271435542.2530
 RUSSIA                    |   1997 | 466310659.7479
 RUSSIA                    |   1996 | 476460994.0192
 RUSSIA                    |   1995 | 468313470.3171
 RUSSIA                    |   1994 | 464270342.4756
 RUSSIA                    |   1993 | 470392488.4815
 RUSSIA                    |   1992 | 465608573.4756
 SAUDI ARABIA              |   1998 | 279556894.6622
 SAUDI ARABIA              |   1997 | 476733124.9732
 SAUDI ARABIA              |   1996 | 464426274.4831
 SAUDI ARABIA              |   1995 | 469859866.1609
 SAUDI ARABIA              |   1994 | 472635554.3490
 SAUDI ARABIA              |   1993 | 462621727.8630
 SAUDI ARABIA              |   1992 | 469127830.8459
 UNITED KINGDOM            |   1998 | 264469198.0441
 UNITED KINGDOM            |   1997 | 451463355.6821
 UNITED KINGDOM            |   1996 | 454869023.3252
 UNITED KINGDOM            |   1995 | 459884883.6244
 UNITED KINGDOM            |   1994 | 466280026.4331
 UNITED KINGDOM            |   1993 | 453451534.6543
 UNITED KINGDOM            |   1992 | 455007638.6837
 UNITED STATES             |   1998 | 266857147.8305
 UNITED STATES             |   1997 | 468266592.4455
 UNITED STATES             |   1996 | 463967025.0631
 UNITED STATES             |   1995 | 464264603.1901
 UNITED STATES             |   1994 | 465194216.0381
 UNITED STATES             |   1993 | 461933965.3578
 UNITED STATES             |   1992 | 462325324.9262
 VIETNAM                   |   1998 | 273417164.6647
 VIETNAM                   |   1997 | 463777404.1553
 VIETNAM                   |   1996 | 467724954.0601
 VIETNAM                   |   1995 | 469119356.9502
 VIETNAM                   |   1994 | 477395131.5624
 VIETNAM                   |   1993 | 467918650.9311
 VIETNAM                   |   1992 | 463133999.8142
(175 rows)

COMMIT;
COMMIT
